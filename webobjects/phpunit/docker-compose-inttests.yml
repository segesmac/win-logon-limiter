services:
   composer:
     image: composer:latest
     volumes:
      - ../:/app
     environment:
      - COMPOSER_CACHE_DIR=/app/var/cache/composer
     restart: never

   phpunit:
     image: ${DOCKER_IMAGE}
     restart: never
     volumes:
       - ../:/app
     working_dir: /app
     entrypoint: vendor/bin/phpunit
     environment:
       WLL_DB_PASSWORD_FILE: /run/secrets/db_password
     secrets:
       - db_password
     networks:
       - network1

networks:
  network1: # this network is the default name of the network created in the deployment folder docker-compose.yml file
    name: deployment_default
    external: true

secrets:
   db_password:
     file: ../../deployment/db_password.txt



# docker-compose -f docker_compose.yml up -d
